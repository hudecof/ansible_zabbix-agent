---
- name: "create zabbix-agentd.conf"
  action: template src={{ item }} dest={{ zabbix_agent_dir_etc }}/zabbix_agentd.conf backup=yes owner=root group={{ zabbix_agent_user }} mode=0640
  first_available_file:
    - zabbix_agentd.conf.j2 
  tags:
    - zabbix-agent
    - config
  notify:
    - restart zabbix-agent

- name: "copy config directory"
  action: copy src={{ zabbix_agent_dir_prefix }}/zabbix-agent.d/ dest={{ zabbix_agent_dir_etc }}/{{ zabbix_agent_dir_include }}/ backup=no owner=root group={{ zabbix_agent_user }} mode=0640
  tags:
    - zabbix-agent
    - config
  notify:
    - restart zabbix-agent

- name: "copy script directory"
  action: copy src={{ zabbix_agent_dir_prefix }}/scripts/ dest={{ zabbix_agent_dir_etc }}/{{ zabbix_agent_dir_scripts }}/ backup=no owner=root group={{ zabbix_agent_user }} mode=0750
  tags:
    - zabbix-agent
    - config
  notify:
    - restart zabbix-agent
